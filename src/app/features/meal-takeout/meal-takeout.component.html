<div class="container">
  <header class="page-header">
    <h1 id="page-title">{{ sharedDataService.title }} - Takeout Options</h1>
    <p id="page-description">{{ sharedDataService.description }}</p>
  </header>

  <main class="page-content">
    <div class="takeout-explanation">
      <p>5 minutes isn't enough time to cook. Let's find takeout options near you!</p>
    </div>

    <div class="action-section" *ngIf="!isLoading && restaurants.length === 0">
      <button mat-raised-button color="primary" class="find-restaurants-button" (click)="findNearbyRestaurants()">
        Find Restaurants Near Me
      </button>
    </div>

    <div class="loading-section" *ngIf="isLoading">
      <mat-spinner></mat-spinner>
      <p class="loading-message">{{ loadingMessage }}</p>
    </div>

    <div class="error-section" *ngIf="errorMessage && !isLoading">
      <p class="error-message">{{ errorMessage }}</p>
    </div>

    <div class="manual-location-section" *ngIf="showManualLocationInput && !isLoading">
      <form [formGroup]="locationForm" (ngSubmit)="searchByManualLocation()">
        <mat-form-field appearance="outline">
          <mat-label>Enter your location</mat-label>
          <input matInput formControlName="manualLocation" placeholder="e.g., New York, NY">
          <mat-error *ngIf="locationForm.get('manualLocation')?.hasError('required')">
            Location is required
          </mat-error>
          <mat-error *ngIf="locationForm.get('manualLocation')?.hasError('minlength')">
            Please enter at least 2 characters
          </mat-error>
        </mat-form-field>
        <button mat-raised-button color="primary" type="submit" [disabled]="locationForm.invalid">
          Search Restaurants
        </button>
      </form>
    </div>

    <div class="restaurants-section" *ngIf="restaurants.length > 0 && !isLoading">
      <h2>Nearby Restaurants</h2>
      <div class="restaurant-list">
        <div class="restaurant-card" *ngFor="let restaurant of restaurants">
          <h3>{{ restaurant.name }}</h3>
          <p class="address">{{ restaurant.address }}</p>
          <div class="restaurant-details">
            <span class="rating" *ngIf="restaurant.rating">
              ⭐ {{ restaurant.rating }}
            </span>
            <span class="price-level" *ngIf="restaurant.priceLevel">
              {{ '$'.repeat(restaurant.priceLevel) }}
            </span>
            <span class="open-status" [class.open]="restaurant.isOpen" [class.closed]="restaurant.isOpen === false">
              {{ restaurant.isOpen === true ? 'Open' : restaurant.isOpen === false ? 'Closed' : 'Hours unknown' }}
            </span>
          </div>
          <div class="restaurant-actions">
            <button mat-button color="primary" *ngIf="restaurant.phoneNumber">
              Call {{ restaurant.phoneNumber }}
            </button>
          </div>
        </div>
      </div>
      <button mat-button (click)="findNearbyRestaurants()" class="search-again-button">
        Search Again
      </button>
    </div>

    <div class="back-section">
      <button mat-button (click)="backToForm()">
        ← Back to Meal Form
      </button>
    </div>
  </main>
</div>
